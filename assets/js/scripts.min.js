var admin={init:function(){ajax.getUsers("returnAdminUsers"),this.bindEvents()},bindEvents:function(){admin.validateAddUser(),admin.validateEditUser(),admin.validateEditCong(),admin.validateAddCong()},validateAddUser:function(){$("form[name='addUserSubmit']").validate({rules:{email:{required:!0,email:!0},password:{required:!0,minlength:8,maxlength:50},phoneNumber:{required:!0,phoneUS:!0},firstName:{required:!0,maxlength:200},lastName:{required:!0,maxlength:200}},submitHandler:function(e){e.submit()}})},validateEditUser:function(){$("form[name='editUserSubmit']").validate({rules:{email:{required:!0,email:!0},phoneNumber:{required:!0,phoneUS:!0},firstName:{required:!0,maxlength:200},lastName:{required:!0,maxlength:200}},submitHandler:function(e){e.submit()}})},validateEditCong:function(){$("form[name='editCongSubmit']").validate({rules:{congregation_name:{required:!0,maxlength:200},congregation_phone:{required:!0,phoneUS:!0},congregation_street_address:{required:!0,maxlength:200},congregation_city:{required:!0,maxlength:200},congregation_state:{required:!0,minlength:2,maxlength:2,lettersonly:!0},congregation_zip:{required:!0,minlength:5,maxlength:5,number:!0}},submitHandler:function(e){e.submit()}})},validateAddCong:function(){$("form[name='addCongSubmit']").validate({rules:{congregation_name:{required:!0,maxlength:200},congregation_phone:{required:!0,phoneUS:!0},congregation_street_address:{required:!0,maxlength:200},congregation_city:{required:!0,maxlength:200},congregation_state:{required:!0,minlength:2,maxlength:2,lettersonly:!0},congregation_zip:{required:!0,minlength:5,maxlength:5,number:!0}},submitHandler:function(e){e.submit()}})}},bus={init:function(){this.bindEvents(),this.populateDrivers()},populateDrivers:function(){ajax.getDrivers("returnDrivers")},bindEvents:function(){$(".add-to-list").on("click",function(e){var i=!1;e.preventDefault(),$("#error-container").empty(),""==$("#bus-name").val()&&(i=!0,$("#error-container").append("<p>A driver is required.</p>")),""==$("#bus-date").val()&&(i=!0,$("#error-container").append("<p>Date(s) is/are required.</p>")),""==$("#bus-time").val()&&(i=!0,$("#error-container").append("<p>Time is required.</p>")),i||bus.populateTable()}),$("#driver-avail-submit").on("click",function(e){e.preventDefault(),bus.submitAvailability()}),$("table#list").on("click","a#delete-date",function(e){e.preventDefault(),bus.removeDriverRecord(this)}),$("#bus-name").on("change",function(e){console.log("changed......");$("option:selected",this);var i=this.value;""!=i&&(console.log("not null"),console.log(i),ajax.getDriverAvailability("returnDriverAvailability",i))})},populateTable:function(){for(var e,i=$("#bus-name").find(":selected").text(),t=$("#bus-date").val().split(","),a=$("#bus-time").val(),n=$("table#list tbody"),r=0;r<t.length;r++)e="<tr>",e+='<td scope="row" class="tableDriverName">'+i+"</td>",e+='<td class="tableDriverDate">'+t[r]+"</td>",e+='<td class="tableDriverTime" >'+a+'<a id="delete-date"><i class="fa fa-minus-circle fa-lg pull-right" aria-hidden="true"></i></a></td>',e+="</tr>",n.append(e)},removeDriverRecord:function(e){$(e).parents().closest("tr").empty().remove()},submitAvailability:function(){var e,i=$("table#list tbody").find("tr"),t=[],a={};$(i).each(function(e,i){$(this).children("td").each(function(e,i){a.id=$("#bus-name").val(),this.classList.contains("tableDriverName")&&(a.name=$(this).text()),this.classList.contains("tableDriverDate")&&(a.date=$(this).text()),this.classList.contains("tableDriverTime")&&(a.time=$(this).text()),2==e&&t.push(a)})}),e=JSON.stringify(t,null,2),console.log(e)}},ajax={ajaxCall:function(e,i){return $.ajax({type:e,async:!0,cache:!1,url:"mid.php",data:i})},getUsers:function(e,i){ajax.ajaxCall("GET",{method:e,file:"admin_handler"}).done(function(e){console.log("getting users..... "),console.log(e)}).fail(function(e){})},getDrivers:function(e,i){ajax.ajaxCall("GET",{method:e,file:"admin_handler"}).done(function(e){$.each($.parseJSON(e),function(e,i){$("#bus-name").append($("<option>",{value:i.userID,text:i.firstName+" "+i.lastName}))}),$("#bus-name").removeAttr("disabled")}).fail(function(e){})},getDriverAvailability:function(e,i){ajax.ajaxCall("GET",{method:e,data:i,file:"admin_handler"}).done(function(e){console.log("availability here......"),console.log(e),$.each($.parseJSON(e),function(e,i){})}).fail(function(e){})}};$(document).ready(function(){$("body").hasClass("bus")&&(bus.init(),$("#date-picker").multiDatesPicker({inline:!0,altField:"#bus-date"}),$("#bus-date").change(function(){$("#date-picker").multiDatesPicker("setDate",$(this).val())})),$("body").hasClass("admin")&&admin.init(),$("body").hasClass("init_login")&&login.init()});var login={init:function(){this.bindEvents()},bindEvents:function(){login.validateLogin(),login.validateEmail(),login.validatePassword()},validateLogin:function(){$("form[name='loginForm']").validate({rules:{account:{required:!0,email:!0},secure:{required:!0}},submitHandler:function(e){e.submit()},messages:{account:{required:"Can't leave email empty"},secure:{required:"Can't leave password empty"}}})},validateEmail:function(){$("form[name='passwordReset']").validate({rules:{account:{required:!0,email:!0}},submitHandler:function(e){e.submit()},messages:{account:{required:"Can't leave email empty"}}})},validatePassword:function(){$("form[name='newFormPassword']").validate({rules:{password:{required:!0,minlength:8,maxlength:50},confirm:{required:!0,equalTo:"#newPassword"}},submitHandler:function(e){e.submit()},messages:{password:{required:"Can't leave password empty"},confirm:{equalTo:"Your confirmed password doesn't match"}}})}};console.log("cong-test"),console.log("helllllooooo");